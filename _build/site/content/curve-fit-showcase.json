{"kind":"Notebook","sha256":"2191cb20ac2f646f2199e4a64808d3d8dcadecaff0e9656e517879704f374bdf","slug":"curve-fit-showcase","location":"/curve_fit_showcase.ipynb","dependencies":[],"frontmatter":{"title":"Showcase","subtitle":"Fitting a Variety of Shapes","date":"2025-01-26","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Atharva Aalok","given":"Atharva","family":"Aalok"},"name":"Atharva Aalok","corresponding":true,"email":"atharvaaalok@gmail.com","affiliations":["Stanford University"],"twitter":"atharvaaalok","github":"atharvaaalok","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/atharvaaalok/neural_injective_geometry","affiliations":[{"id":"Stanford University","name":"Stanford University"}],"exports":[{"format":"ipynb","filename":"curve_fit_showcase.ipynb","url":"/curve_fit_showcase-e6bdb4f92519654f22c0d9928bb6e6e5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Basic imports\nimport torch\nfrom torch import nn\n\nfrom assets.shapes import square, circle, stanford_bunny\nfrom assets.loss_functions import mse\nfrom assets.utils import automate_training, plot_curves","key":"KHIL1yOY1h"},{"type":"output","id":"XQR0MbjYf6xX2J5zJ-Hmq","data":[],"key":"sa5yW4BkwO"}],"key":"IwgHDEFHiy"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Showcase","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YPHWdszTET"}],"identifier":"showcase","label":"Showcase","html_id":"showcase","implicit":true,"key":"ljE0fP1PHp"}],"key":"uaWIjGKOdY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Heart","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ooF1uKWnfJ"}],"identifier":"heart","label":"Heart","html_id":"heart","implicit":true,"key":"yRscIOsHxq"}],"key":"F7b36bkMCI"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import heart\nfrom assets.networks import NIG_Net\n\n# Generate target curve points\nnum_pts = 1000\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\nX_t = heart(num_pts)\n\nnig_net = NIG_Net(\n    layer_count_inj = 4, smm_num_grps = 6, smm_neurons_per_grp = 6\n)\nautomate_training(\n    model = nig_net, loss_fn = mse, X_train = t, Y_train = X_t,\n    learning_rate = 0.001, epochs = 10000, print_cost_every = 2000\n)\n\nX_p = nig_net(t)\nplot_curves(X_p, X_t)","key":"vUboUz70dX"},{"type":"output","id":"I0aEMQqLT-iljEhv4OaCm","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [    1/10000]. Loss:    0.000195\nEpoch: [ 2000/10000]. Loss:    0.000135\nEpoch: [ 4000/10000]. Loss:    0.000096\nEpoch: [ 6000/10000]. Loss:    0.000079\nEpoch: [ 8000/10000]. Loss:    0.000068\nEpoch: [10000/10000]. Loss:    0.000062\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4c88e58b93ec05d9dbc3547e5f9bfe07","path":"/4c88e58b93ec05d9dbc3547e5f9bfe07.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"AjfxECXAD4"}],"key":"KCzceSbiuq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Puzzle Piece","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pXpVQcv8RP"}],"identifier":"puzzle-piece","label":"Puzzle Piece","html_id":"puzzle-piece","implicit":true,"key":"YBj80Lzj4a"}],"key":"waQ9nKF0Fz"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import puzzle_piece\nfrom assets.networks import NIG_Net\n\n# Generate target curve points\nnum_pts = 1000\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\nX_t = puzzle_piece(num_pts)\n\nnig_net = NIG_Net(\n    layer_count_inj = 5, smm_num_grps = 15, smm_neurons_per_grp = 15\n)\nautomate_training(\n    model = nig_net, loss_fn = mse, X_train = t, Y_train = X_t,\n    learning_rate = 0.1, epochs = 1000, print_cost_every = 200\n)\n\nX_p = nig_net(t)\nplot_curves(X_p, X_t)","key":"ssWhLH3W87"},{"type":"output","id":"1u3AiPYxrB3kj8435KFGs","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [    1/10000]. Loss:    0.000886\nEpoch: [ 2000/10000]. Loss:    0.000847\nEpoch: [ 4000/10000]. Loss:    0.000819\nEpoch: [ 6000/10000]. Loss:    0.000797\nEpoch: [ 8000/10000]. Loss:    0.000781\nEpoch: [10000/10000]. Loss:    0.000771\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8afca5bc2b227f7156e683fba4a672bb","path":"/8afca5bc2b227f7156e683fba4a672bb.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"BxxgSiUNpJ"}],"key":"DiqoHuoMNn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we try to fit the puzzle piece using a Pre-Auxilliary network augmented NIG_Net.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L5PB5vvYEh"}],"key":"CdYeG3ODHW"}],"key":"VibmgizD73"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import puzzle_piece\nfrom assets.networks import PreAux_NIG_Net\n\n# Generate target curve points\nnum_pts = 1000\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\nX_t = puzzle_piece(num_pts)\n\npreaux_nig_net = PreAux_NIG_Net(\n    layer_count_inj = 5, smm_num_grps = 15, smm_neurons_per_grp = 15,\n    layer_count_preaux = 2, hidden_dim_preaux = 25\n)\nautomate_training(\n    model = preaux_nig_net, loss_fn = mse, X_train = t, Y_train = X_t,\n    learning_rate = 0.1, epochs = 10000, print_cost_every = 2000\n)\n\nX_p = preaux_nig_net(t)\nplot_curves(X_p, X_t)","key":"h9drJ45eam"},{"type":"output","id":"0ma6uiUV1GLxtRXAUowzK","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [    1/10000]. Loss:    0.000139\nEpoch: [ 2000/10000]. Loss:    0.000130\nEpoch: [ 4000/10000]. Loss:    0.000122\nEpoch: [ 6000/10000]. Loss:    0.000116\nEpoch: [ 8000/10000]. Loss:    0.000111\nEpoch: [10000/10000]. Loss:    0.000107\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"19b91c27de1e338ffcd82fc44aea9e8e","path":"/19b91c27de1e338ffcd82fc44aea9e8e.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"GLv1W9K5x1"}],"key":"FqHIU9rdU2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Hand","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZYZLEoicUF"}],"identifier":"hand","label":"Hand","html_id":"hand","implicit":true,"key":"QsLWhYi9AV"}],"key":"xhQzs9kj5N"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import hand\nfrom assets.networks import NIG_Net\n\n# Generate target curve points\nnum_pts = 1000\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\nX_t = hand(num_pts)\n\nnig_net = NIG_Net(\n    layer_count_inj = 5, smm_num_grps = 15, smm_neurons_per_grp = 15\n)\nautomate_training(\n    model = nig_net, loss_fn = mse, X_train = t, Y_train = X_t,\n    learning_rate = 0.1, epochs = 10000, print_cost_every = 2000\n)\n\nX_p = nig_net(t)\nplot_curves(X_p, X_t)","key":"riHu7aZaIs"},{"type":"output","id":"R_a4IkT81vj97HI1Lgb3Z","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [    1/10000]. Loss:    0.006448\nEpoch: [ 2000/10000]. Loss:    0.006356\nEpoch: [ 4000/10000]. Loss:    0.006282\nEpoch: [ 6000/10000]. Loss:    0.006229\nEpoch: [ 8000/10000]. Loss:    0.006209\nEpoch: [10000/10000]. Loss:    0.006203\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dd969d78d2c749047823857e854e77f5","path":"/dd969d78d2c749047823857e854e77f5.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"FGv9oLfeIU"}],"key":"EFYCm6NUgJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import hand\nfrom assets.networks import PreAux_NIG_Net\n\n# Generate target curve points\nnum_pts = 1000\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\nX_t = hand(num_pts)\n\npreaux_nig_net = PreAux_NIG_Net(\n    layer_count_inj = 5, smm_num_grps = 15, smm_neurons_per_grp = 15,\n    layer_count_preaux = 2, hidden_dim_preaux = 25\n)\nautomate_training(\n    model = preaux_nig_net, loss_fn = mse, X_train = t, Y_train = X_t,\n    learning_rate = 0.1, epochs = 10000, print_cost_every = 2000\n)\n\nX_p = preaux_nig_net(t)\nplot_curves(X_p, X_t)","key":"yShdgtb19l"},{"type":"output","id":"wyR4Uu2wPkckCfULfguDK","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [    1/10000]. Loss:    5.759819\nEpoch: [ 2000/10000]. Loss:    0.000795\nEpoch: [ 4000/10000]. Loss:    0.000226\nEpoch: [ 6000/10000]. Loss:    0.000147\nEpoch: [ 8000/10000]. Loss:    0.000130\nEpoch: [10000/10000]. Loss:    0.000121\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c40805cad7163a8d550ead9c096b9e23","path":"/c40805cad7163a8d550ead9c096b9e23.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"ZSuuWACqrC"}],"key":"KgXXH4nk8Y"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Airplane","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nneA7D5zP2"}],"identifier":"airplane","label":"Airplane","html_id":"airplane","implicit":true,"key":"C5YNS5IVLl"}],"key":"tCybHsiUxB"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import airplane\nfrom assets.networks import NIG_Net\n\n# Generate target curve points\nnum_pts = 1000\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\nX_t = airplane(num_pts)\n\nnig_net = NIG_Net(\n    layer_count_inj = 5, smm_num_grps = 10, smm_neurons_per_grp = 10\n)\nautomate_training(\n    model = nig_net, loss_fn = mse, X_train = t, Y_train = X_t,\n    learning_rate = 0.1, epochs = 1000, print_cost_every = 200\n)\n\nX_p = nig_net(t)\nplot_curves(X_p, X_t)","key":"HjNOHaSPZr"},{"type":"output","id":"GDsuCBY9hXpaBQXDpJYmD","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [   1/1000]. Loss:    1.272580\nEpoch: [ 200/1000]. Loss:    0.343534\nEpoch: [ 400/1000]. Loss:    0.057192\nEpoch: [ 600/1000]. Loss:    0.056915\nEpoch: [ 800/1000]. Loss:    0.055601\nEpoch: [1000/1000]. Loss:    0.054936\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d0a9ea3ccb0dcca12feb4cc44da5146c","path":"/d0a9ea3ccb0dcca12feb4cc44da5146c.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"ZRrHkuINRB"}],"key":"dWvqt0v8Ac"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import airplane\nfrom assets.networks import PreAux_NIG_Net\n\n# Generate target curve points\nnum_pts = 1000\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\nX_t = airplane(num_pts)\n\npreaux_nig_net = PreAux_NIG_Net(\n    layer_count_inj = 2, smm_num_grps = 15, smm_neurons_per_grp = 15,\n    layer_count_preaux = 2, hidden_dim_preaux = 50\n)\nautomate_training(\n    model = preaux_nig_net, loss_fn = mse, X_train = t, Y_train = X_t,\n    learning_rate = 0.001, epochs = 10000, print_cost_every = 2000\n)\n\nX_p = preaux_nig_net(t)\nplot_curves(X_p, X_t)","key":"BrZgovVjFf"},{"type":"output","id":"r-Vc_GMM83cBLkNmGTG_5","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [    1/10000]. Loss:    0.000482\nEpoch: [ 2000/10000]. Loss:    0.000471\nEpoch: [ 4000/10000]. Loss:    0.000455\nEpoch: [ 6000/10000]. Loss:    0.000442\nEpoch: [ 8000/10000]. Loss:    0.000430\nEpoch: [10000/10000]. Loss:    0.000424\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6f0636f1342d59e9a6dd4dece05ff0b5","path":"/6f0636f1342d59e9a6dd4dece05ff0b5.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"E6d360JsmM"}],"key":"rM6nQRjCAY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Surprisingly to fit this the NIG Network required is quite small and the PreAux-Net is large.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gk02IRL5mH"}],"key":"yM87Evm1vW"}],"key":"NOFuOZI0aX"}],"key":"SShVTLtLk4"},"references":{"cite":{"order":[],"data":{}}}}