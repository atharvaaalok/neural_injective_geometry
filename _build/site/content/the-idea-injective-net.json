{"kind":"Notebook","sha256":"6fc253a9caaccb69b055a8a9e5d0d2b1ad5e9d0f01a2ab64f94a83cf0cea1a0c","slug":"the-idea-injective-net","location":"/the_idea_injective_net.ipynb","dependencies":[],"frontmatter":{"title":"Injective Networks","subtitle":"The Central Idea behind Neural Injective Geometry","date":"2025-01-22","kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Atharva Aalok","given":"Atharva","family":"Aalok"},"name":"Atharva Aalok","corresponding":true,"email":"atharvaaalok@gmail.com","affiliations":["Stanford University"],"twitter":"atharvaaalok","github":"atharvaaalok","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/atharvaaalok/neural_injective_geometry","affiliations":[{"id":"Stanford University","name":"Stanford University"}],"thumbnail":"/curve_types-51f2a05f39efb383d540e8328dc8dbe1.svg","exports":[{"format":"ipynb","filename":"the_idea_injective_net.ipynb","url":"/the_idea_injective_n-d4b7bec43e6391e598d6cb0883e4c49e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"%pip install numpy\n%pip install matplotlib\n%pip install ipywidgets","key":"YMYknCpbB3"},{"type":"output","id":"fbC4w_ywyQhYq8pr0Q_7s","data":[],"key":"OQ95LNeXay"}],"key":"V3IF5wgDrg"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"%pip install svg.path\n%pip install torch","key":"TMHyNy3KVY"},{"type":"output","id":"c78GEPI7h3sAPBqrXVwCz","data":[],"key":"MqsDDUZgVo"}],"key":"sfXTiY6mt6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Neural Injective Curves","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XtdKfUBLmD"}],"identifier":"neural-injective-curves","label":"Neural Injective Curves","html_id":"neural-injective-curves","implicit":true,"key":"OoqtSFef4E"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We now discuss the abstract idea behind our shape parameterization to represent general simple\nclosed curves in the plane. As we shall see, this approach is conceptual and to actually create\ncurves a construction method is needed. Our method is based on neural networks with special\narchitectures that work as construction methods. We will see that the basic neural network\narchitecture is a very natural approach for constructing non-self-intersecting curves.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"xscnqPtqbK"}],"key":"lPE3e7uxBD"}],"key":"Jqkh49p4Dj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cartesian Neural Injective Curves","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TH6ce0RPp0"}],"identifier":"cartesian-neural-injective-curves","label":"Cartesian Neural Injective Curves","html_id":"cartesian-neural-injective-curves","implicit":true,"key":"WBlbf1jBUh"}],"key":"AoSELfAkod"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Consider the following parameterization to represent curves:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sptfDFhhVI"}],"key":"MyxuGjmpMj"},{"type":"math","tight":true,"value":"\\begin{align*}\nx &= f(t)\\\\\ny &= g(t), \\quad t \\in [0, 1]\n\\end{align*}","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\nx &amp;= f(t)\\\\\ny &amp;= g(t), \\quad t \\in [0, 1]\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.75em;\"><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.75em;\"><span style=\"top:-3.91em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.25em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"1","key":"XeQYwi3VS9"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"This representation can potentially represent any curve in the plane not necessarily simple and\nclosed.  Thus it is ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Gf9GrPRuRr"},{"type":"emphasis","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"too broad","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OIK442EoTs"}],"key":"IZdn6bvIh3"},{"type":"text","value":", we want the functions ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZGoYa9ZDDv"},{"type":"inlineMath","value":"f","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"qRPc5MBkbL"},{"type":"text","value":" and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"x6zJV0UVMt"},{"type":"inlineMath","value":"g","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"ygUS39Q9XV"},{"type":"text","value":" to be such that we only\nrepresent ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bH3IZDGO8v"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"simple","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZMLKfEBXns"}],"key":"VmyHr5EOzx"},{"type":"text","value":" and ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kTk3cVqCD4"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"closed","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VTJnpOD10g"}],"key":"HQXuUjZdpb"},{"type":"text","value":" curves.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ErjKdet2cW"}],"key":"OZ0LH233Wo"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/curve_types-51f2a05f39efb383d540e8328dc8dbe1.svg","alt":"Four types of curves: simple/not simple + closed/not closed","height":"290px","key":"qlj9fRFBQw","urlSource":"assets/curve_types.svg"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"curve_types","identifier":"curve_types","html_id":"curve-types","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"DCEuMGEunO"},{"type":"text","value":"1","key":"cOtFPdfSzx"},{"type":"text","value":":","key":"ZdWNsExAAj"}],"template":"Figure %s:","key":"ugQDsOFhaq"},{"type":"text","value":"We will be concerned with simple closed curves, i.e. curves that loop back and do not\nself-intersect.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"I2f7drz440"}],"key":"UQgmVdB2MH"}],"key":"bJyelGOpWk"}],"label":"curve_types","identifier":"curve_types","enumerator":"1","html_id":"curve-types","key":"VPyvMyQwaN"},{"type":"definitionList","position":{"start":{"line":18,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"definitionTerm","position":{"start":{"line":18,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Simple","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"sud4bDIasA"}],"key":"rrZWpHqgJx"},{"type":"definitionDescription","position":{"start":{"line":19,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"A curve is simple if it does not self-intersect. That is, two different ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"P6jlcHrXlX"},{"type":"inlineMath","value":"t","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"XpUELEQlRM"},{"type":"text","value":" values should not map\nto the same point in the plane. Mathematically,\n","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"rneyuGw8dO"},{"type":"math","value":"\nt_1 \\neq t_2 \\implies (x(t_1), y(t_1)) \\neq (x(t_2), y(t_2))","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo mathvariant=\"normal\">≠</mo><msub><mi>t</mi><mn>2</mn></msub><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo mathvariant=\"normal\">≠</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">(</mo><msub><mi>t</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\nt_1 \\neq t_2 \\implies (x(t_1), y(t_1)) \\neq (x(t_2), y(t_2))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"2","key":"ORomTZaV9Z"}],"key":"UDYvLfd58v"},{"type":"definitionTerm","position":{"start":{"line":25,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Closed","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"rXycCAjIWV"}],"key":"uSXNKLEMFJ"},{"type":"definitionDescription","position":{"start":{"line":25,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"A curve is ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"tuJInxOCfU"},{"type":"emphasis","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"closed","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"CktS1lkNsX"}],"key":"qfisV1rcYY"},{"type":"text","value":" if the starting and the ending points are the same. Mathematically,\n","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"ofl6VHVLMQ"},{"type":"math","value":"\n(x(0), y(0)) = (x(1), y(1))","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\n(x(0), y(0)) = (x(1), y(1))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">))</span></span></span></span></span>","enumerator":"3","key":"h4uNhlcqmY"}],"key":"y2pbhx3rCO"}],"key":"Br48js1hgK"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"If these additional constraints are satisfied by the functions ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"WCCGcQRd1R"},{"type":"inlineMath","value":"f","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"IgxIIemr32"},{"type":"text","value":" and ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"p1rRht2mj3"},{"type":"inlineMath","value":"g","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"OjINu7xx9N"},{"type":"text","value":" then the curves\ngenerated will be guaranteed to be simple closed curves. We now discuss a way of constructing\nfunctions ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"l8K8F4uROY"},{"type":"inlineMath","value":"f","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"eRCQJutwLt"},{"type":"text","value":" and ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"P0rt1qfQo4"},{"type":"inlineMath","value":"g","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"ioUaWyZSAw"},{"type":"text","value":" such that they always satisfy these constraints.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ovZgNLPrdt"}],"key":"GU58T4Fwr6"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"To create a construction mechanism we need to first look at the problem differently through a single\nvector-valued mapping instead of two scalar-valued functions ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"RrS8Iv6lWn"},{"type":"inlineMath","value":"f","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"TXVctzria7"},{"type":"text","value":" and ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"UOdXhlFqHY"},{"type":"inlineMath","value":"g","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"OvtdnjQVZK"},{"type":"text","value":". Consider also, instead of\ntwo scalar values ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"l8b0U0Ury1"},{"type":"inlineMath","value":"x","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"gFLnisWbUy"},{"type":"text","value":" and ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"xy4vKcCE2y"},{"type":"inlineMath","value":"y","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"GJ7g5JMkjJ"},{"type":"text","value":", a single vector which has the two values stacked ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"fXI1qhNatN"},{"type":"inlineMath","value":"[x, y]^{T}","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">[x, y]^{T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span>","key":"YagSKukXpD"},{"type":"text","value":".\nThis vector is parameterized as before through a parameter ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"AbY1DsDR1u"},{"type":"inlineMath","value":"t","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"grQLVoEcNj"},{"type":"text","value":". Concretely, consider a vector-valued\nmapping ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"aLlLPgGPKe"},{"type":"inlineMath","value":"F","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>","key":"MnE37sBysT"},{"type":"text","value":" that maps ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"jltbLrIvva"},{"type":"inlineMath","value":"t","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"odfYs2N7kW"},{"type":"text","value":" to the vector of ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"ubJoGP3zBV"},{"type":"inlineMath","value":"x","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"oSwYPtjRfS"},{"type":"text","value":" and ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"Ma8zbjiTqQ"},{"type":"inlineMath","value":"y","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"gO6ZElPZAF"},{"type":"text","value":".","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"TdrTrzOZ79"}],"key":"TgCi29uU0p"},{"type":"math","value":"F: t \\rightarrow\n\\begin{bmatrix}\nx\\\\\ny\n\\end{bmatrix}","tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>F</mi><mo>:</mo><mi>t</mi><mo>→</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>y</mi></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">F: t \\rightarrow\n\\begin{bmatrix}\nx\\\\\ny\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"4","key":"o5ZB1uUPZR"}],"key":"jO02cArKNn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Condition 1 - Simple Curves","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QJAZGZqqTf"}],"identifier":"condition-1-simple-curves","label":"Condition 1 - Simple Curves","html_id":"condition-1-simple-curves","implicit":true,"key":"ZRKeGIiW6S"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For the curves represented through the mapping ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sAtrq9B9qv"},{"type":"inlineMath","value":"F","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>","key":"TG1BioxkFQ"},{"type":"text","value":" to be simple, we need ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"m9yzJMFd4L"},{"type":"inlineMath","value":"F","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>","key":"DIAZXdcRjw"},{"type":"text","value":" to be an\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"eDdqBL7jqK"},{"type":"link","url":"https://en.wikipedia.org/wiki/Injective_function","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"injective","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"P7R6DFac8x"}],"urlSource":"https://en.wikipedia.org/wiki/Injective_function","data":{"page":"Injective_function","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"Z7XrCNkgQp"},{"type":"text","value":" map as then every ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"w8rJV2nJZn"},{"type":"inlineMath","value":"t","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"YIMUp1jQXc"},{"type":"text","value":" value will map\nto a different point in the plane and does not self-intersect. We will now see how neural networks\nare quite naturally suited for this.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EtTTK0L77Z"}],"key":"InpKoMEUIs"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Consider the specific neural network architecture shown in\n","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JcZjfgRmjS"},{"type":"crossReference","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Figure ","key":"jdmOhWwbTI"},{"type":"text","value":"2","key":"MhpjbIHYHx"}],"identifier":"neural_network_architecture_injective","label":"neural_network_architecture_injective","kind":"figure","template":"Figure %s","enumerator":"2","resolved":true,"html_id":"neural-network-architecture-injective","key":"IIUyvOONRa"},{"type":"text","value":":","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Dq1X0JWrV8"}],"key":"wjEyVuw7iP"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/neural_network_archi-41760c6c9fafe514fcb2577122aa2eff.svg","alt":"Figure showing a basic neural network architecture that preserves injectivity at each layer.","height":"210px","key":"psfUYhlxPC","urlSource":"assets/neural_network_architecture_injective.svg"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"neural_network_architecture_injective","identifier":"neural_network_architecture_injective","html_id":"neural-network-architecture-injective","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"xq6qU6CJYj"},{"type":"text","value":"2","key":"nRWERsjvFg"},{"type":"text","value":":","key":"a83luq8Qrr"}],"template":"Figure %s:","key":"unpFWZXSEv"},{"type":"text","value":"If each layer is injective then the composition of these i.e. the entire network will also be\ninjective.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yCR19eoKIQ"}],"key":"DChZ3xaugp"}],"key":"p4s7BaZZnb"}],"label":"neural_network_architecture_injective","identifier":"neural_network_architecture_injective","enumerator":"2","html_id":"neural-network-architecture-injective","key":"hpGwWO7RFA"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"We now see each transformation of the network one by one. At the first layer the mapping from ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"MUDCDyhicd"},{"type":"inlineMath","value":"t","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"HIeMBBdy3w"},{"type":"text","value":" to\na vector ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"wfjkx88qbs"},{"type":"inlineMath","value":"At","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">At</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"ElZU3SYE3v"},{"type":"text","value":" of ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"N2KeTNvNHL"},{"type":"inlineMath","value":"\\dim 2","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>dim</mi><mo>⁡</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\dim 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mop\">dim</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"Ly5HIgqPoj"},{"type":"text","value":" is performed by a column vector ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"NkAjaheHMw"},{"type":"inlineMath","value":"A","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"d2rGu0vlYG"},{"type":"text","value":" and is one to one. The next mapping\nby a non-linear activation function ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xLyKAqrRFz"},{"type":"inlineMath","value":"\\sigma(z)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"JwIZtfuNS9"},{"type":"text","value":" is an element-wise mapping. If we choose our\nactivation function to be an injective function, such as the sigmoid, PReLU, ELU etc. then the\nmapping it produces from one vector to the next will also be injective. Note here that we cannot use\nthe ReLU as it is not an injective function. Now consider the mapping from a ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"jqL7cGNdz0"},{"type":"inlineMath","value":"\\dim 2","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>dim</mi><mo>⁡</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\dim 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mop\">dim</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"qdCuoPMC8q"},{"type":"text","value":" vector to\nanother produced by some ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"wgY1ZHaJDi"},{"type":"inlineMath","value":"2 \\times 2","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2 \\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"WZUPBgMrAc"},{"type":"text","value":" matrix ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"G1LHEj6HWQ"},{"type":"inlineMath","value":"B","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>","key":"appoD74cck"},{"type":"text","value":". ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"nHSX6lXktP"},{"type":"emphasis","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"This mapping is injective with probability 1!","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"wCkqo1Db6V"}],"key":"u63aXFqRlV"},{"type":"text","value":"\n","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"tJBjloFi0H"},{"type":"footnoteReference","identifier":"injective_matrix_probability","label":"injective_matrix_probability","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"number":1,"enumerator":"1","key":"vzxRcwb5lu"},{"type":"text","value":". That is, if we generate a random ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"mht7a0AGDR"},{"type":"inlineMath","value":"2 \\times 2","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2 \\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"Bo7l0zY6Iq"},{"type":"text","value":" matrix ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ppd7mNjSip"},{"type":"inlineMath","value":"B","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>","key":"nxJGMaLbna"},{"type":"text","value":" then it is\ninjective with probability 1. The neural network is composed of these linear and non-linear mappings\nin a sequence. Since the composition of two injective mappings is injective","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Ipywb5xYW0"},{"type":"footnoteReference","identifier":"injective_composition","label":"injective_composition","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"number":2,"enumerator":"2","key":"V2MK9ngqD7"},{"type":"text","value":",\nthe entire network is injective as a whole. Thus the mapping ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"R2TBN4ZYoP"},{"type":"inlineMath","value":"F","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>","key":"O4HLlVSzz7"},{"type":"text","value":" from ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"buyHxPxT1r"},{"type":"inlineMath","value":"t","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"jnR4OgOVWt"},{"type":"text","value":" to ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"qG1TTMxUal"},{"type":"inlineMath","value":"[x, y]^{T}","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">[x, y]^{T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span>","key":"Q7gVa1ltIZ"},{"type":"text","value":" is an\ninjective map. Hence, the curves produced by it will be simple curves.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Cw5AxsbyfI"}],"key":"pLRIrCQfvN"},{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Crucial: Hidden layer size 2","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"lfeiWTZxHR"}],"key":"zOQh5mwKMq"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"A neural network constructed as above is injective with ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"vBOUuH4VBf"},{"type":"emphasis","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"probability 1","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"rxfwhoNr1F"}],"key":"e2Fg9NDlUG"},{"type":"text","value":". The critical information\nused in the construction of the network was that we maintain a hidden layer size of 2 which leads to\nthe matrices ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"iuwWD40OAl"},{"type":"inlineMath","value":"B","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span>","key":"MFzRU9sceK"},{"type":"text","value":" being injective. If we had produced larger hidden layers, say of size ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"B94ZyleG2v"},{"type":"inlineMath","value":"m","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"tk7xhTlroL"},{"type":"text","value":", then we\nwould eventually have to reduced the size back to 2 because our output is a ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"CYZ24qm6sN"},{"type":"inlineMath","value":"\\dim 2","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>dim</mi><mo>⁡</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">\\dim 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mop\">dim</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"cUf81b6yd4"},{"type":"text","value":" vector\nrepresenting ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"BDOZ65m1VG"},{"type":"inlineMath","value":"x","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"mmHjVYzXLk"},{"type":"text","value":" and ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"kCqCNumqDZ"},{"type":"inlineMath","value":"y","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"Zlrl3wGFNo"},{"type":"text","value":" and a ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"FjzLtMIyhR"},{"type":"inlineMath","value":"m \\times 2","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">m \\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"rfANpHyyHY"},{"type":"text","value":" matrix that would produce this would not be injective in\nmost cases.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"pmUe5UGXGU"}],"key":"DgJXYY9ZkO"}],"key":"mqlJkUvOaZ"},{"type":"footnoteDefinition","identifier":"injective_matrix_probability","label":"injective_matrix_probability","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"A square ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"khhCMrqNaZ"},{"type":"inlineMath","value":"n \\times n","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n \\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"lyeRrIMdy5"},{"type":"text","value":" matrix is not injective if and only if it is\nnot invertible.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"MvIaxP3cml"}],"key":"AQqzVX5B0H"},{"type":"container","kind":"quote","children":[{"type":"blockquote","position":{"start":{"line":41,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Singular matrices are rare in the sense that if a square matrix’s entries are randomly\nselected from any bounded region on the number line or complex plane, the probability that the\nmatrix is singular is 0, that is, it will “almost never” be singular.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"CX7Btsv1fG"}],"key":"uCAdRgRr6B"}],"key":"H4qdzdmcTx"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"link","url":"https://en.wikipedia.org/wiki/Invertible_matrix#Definition","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Wikipedia, Invertible Matrix","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"mnqhjFDyrH"}],"urlSource":"https://en.wikipedia.org/wiki/Invertible_matrix#Definition","data":{"page":"Invertible_matrix#Definition","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"PZPrMbvNbr"}],"key":"u9hy8cqRpg"}],"key":"gjtoKg02k3"}],"key":"Y3C6y6xgJm"}],"number":1,"enumerator":"1","key":"WMew5CNhQI"},{"type":"footnoteDefinition","identifier":"injective_composition","label":"injective_composition","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Composition of two injective functions ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"LyQR7OwoPB"},{"type":"inlineMath","value":"f","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"DRShCoLOpw"},{"type":"text","value":" and ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"RWsbWc9jRq"},{"type":"inlineMath","value":"g","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"j6KfZBpcEf"},{"type":"text","value":", ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"KGKEioyOsN"},{"type":"inlineMath","value":"f \\circ g","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>∘</mo><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">f \\circ g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∘</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"TXzyw0zaaQ"},{"type":"text","value":" is also\ninjective.\n","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ft8Bwts6Ov"},{"type":"link","url":"https://en.wikipedia.org/wiki/Injective_function#Other_properties","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Wikipedia, Injective function","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"jDtyvipRns"}],"urlSource":"https://en.wikipedia.org/wiki/Injective_function#Other_properties","data":{"page":"Injective_function#Other_properties","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"mszCS9jSfZ"}],"key":"ZOhzHYK0CS"}],"number":2,"enumerator":"2","key":"iFcHPv70TB"}],"key":"yKzDoZpwX6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Condition 2 - Closed Curves","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LwPT1yI4cS"}],"label":"closed_transformation","identifier":"closed_transformation","html_id":"closed-transformation","key":"zroemnlmBQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For the curves represented through ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dnYpNOtkNE"},{"type":"inlineMath","value":"F","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>","key":"hIdZNYCqmJ"},{"type":"text","value":" to be closed, we need the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k9rBlvAcQ6"},{"type":"inlineMath","value":"x","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"EwqYWOlzAZ"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cjcoR4Xsl1"},{"type":"inlineMath","value":"y","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"DEQYrUjU2g"},{"type":"text","value":" values to be the same\nat ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UZgp10YudR"},{"type":"inlineMath","value":"t = 0, 1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t = 0, 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"pf7PQ7M9Vu"},{"type":"text","value":". Note, that this has to be in-built into the mapping without affecting the injectivity\nproperty that we achieved before. One way is to first produce the transformation:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hFROO7SKIs"}],"key":"DVmlez73yz"},{"type":"math","value":"C(t) = \n\\begin{bmatrix}\ncos(2\\pi t)\\\\\nsin(2\\pi t)\n\\end{bmatrix}","tight":"before","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">C(t) = \n\\begin{bmatrix}\ncos(2\\pi t)\\\\\nsin(2\\pi t)\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">in</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"5","key":"tBTjRPOpJM"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"This mapping is injective for ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"pD8p9pWNB4"},{"type":"inlineMath","value":"t \\in [0, 1)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">t \\in [0, 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"xT7mxRfmnr"},{"type":"text","value":" and also satisfies ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"wWS1RNhhfa"},{"type":"inlineMath","value":"C(0) = C(1)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mi>C</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">C(0) = C(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"bMdJKmNJHb"},{"type":"text","value":". Therefore, we use\nthis as the first transformation before applying the linear and non-linear activation layers. The\nmodified neural network architecture is shown in\n","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"DHobz8WOCJ"},{"type":"crossReference","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Figure ","key":"AwnyM7REAZ"},{"type":"text","value":"3","key":"ERIoATkFiM"}],"identifier":"neural_network_architecture_injective_and_closed","label":"neural_network_architecture_injective_and_closed","kind":"figure","template":"Figure %s","enumerator":"3","resolved":true,"html_id":"neural-network-architecture-injective-and-closed","key":"XsONHwtbme"},{"type":"text","value":":","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"zKt3INiPb1"}],"key":"ofhbCDPkKm"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/neural_network_archi-eef9f68e9caef9588b53d5778555d71b.svg","alt":"Figure showing a modified neural network architecture that produces closed curves.","height":"210px","key":"jHV2iSVhRA","urlSource":"assets/neural_network_architecture_injective_and_closed.svg"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"neural_network_architecture_injective_and_closed","identifier":"neural_network_architecture_injective_and_closed","html_id":"neural-network-architecture-injective-and-closed","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"Y9Fp9BZwVy"},{"type":"text","value":"3","key":"jOBWHxQ0Yr"},{"type":"text","value":":","key":"YhSBAL1s2Z"}],"template":"Figure %s:","key":"UFIOhycW4z"},{"type":"text","value":"This modified neural network architecture produces closed curves. Also, since the entire network is\ninjective the curves produced will also be non-self-intersecting.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"dLFWXWNumA"}],"key":"PxBS1KwEqK"}],"key":"ecxNbTJcPv"}],"label":"neural_network_architecture_injective_and_closed","identifier":"neural_network_architecture_injective_and_closed","enumerator":"3","html_id":"neural-network-architecture-injective-and-closed","key":"FhyTfRN7Go"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"We now have ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"Y8H3VFBpwf"},{"type":"inlineMath","value":"F(0) = F(1)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mi>F</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">F(0) = F(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"sx2HoE2v5z"},{"type":"text","value":" and the mapping ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"wCVAN0cW5t"},{"type":"inlineMath","value":"F","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>","key":"N1pGN0WOoS"},{"type":"text","value":" is also injective with probability 1!","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"AaDhcf9cO9"}],"key":"YgOhIVXTCh"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"We call this architecture the ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"EjES3BwMVC"},{"type":"strong","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Injective Network","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"VhmX5713oV"}],"key":"fkLY3DeiCw"}],"key":"gnr8rCxg3z"},{"type":"text","value":".","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"lIh5861yMA"}],"key":"s2UMYcxAYp"}],"key":"f4twFy17Il"}],"key":"jLYc9vXX5f"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RoRL4REgsL"}],"identifier":"implementation","label":"Implementation","html_id":"implementation","implicit":true,"key":"AehVfQyfZd"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We first do a basic implementation of an Injective Network.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"g9px3eA39G"}],"key":"Enzsr60SuB"}],"key":"hAQ5YdGNSn"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\nnp.random.seed(42)\n\ndef injective_net(t):\n    # Perform the transformation for closed curves\n    z = np.hstack([np.cos(2 * np.pi * t), np.sin(2 * np.pi * t)])\n    a = np.tanh(z)\n\n    # Perform the linear and non-linear transformations\n    layer_count = 2\n    for i in range(layer_count):\n        # We subtract 0.5, without it the shapes will be extremely thin like lines\n        A = np.random.random((2, 2)) - 0.5\n        z = a @ A\n        a = np.tanh(z)\n    \n    return a\n\nnum_pts = 1000\nt = np.linspace(0, 1, num_pts).reshape(-1, 1)\n\nX = injective_net(t)\n\nplt.plot(X[:, 0], X[:, 1])\nplt.show()","key":"cuoBd1QTWc"},{"type":"output","id":"2uPQMJdkX9EktzVvTVk_e","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6417cf9988b409e0efb721c64bf10d3c","path":"/6417cf9988b409e0efb721c64bf10d3c.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"nDiQGNt2gH"}],"key":"ueSiU8Hid6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Now we generate random shapes to get a flavor of the variety of shapes that the parameterization can\nrepresent. Click the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i1PJkzIHQQ"},{"type":"keyboard","children":[{"type":"text","value":"Generate Curve","key":"V2Ixmh7LB7"}],"key":"ENRVgkIksL"},{"type":"text","value":" button below to initialize random ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b705a1ueFR"},{"type":"inlineMath","value":"A","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>","key":"QymuqNi4Kd"},{"type":"text","value":" matrices and\nvisualize the resulting curves. The activation function used is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l9UpX0rryD"},{"type":"inlineCode","value":"LeakyReLU","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SNHtUlaeSt"},{"type":"text","value":" and it’s a 2 layer deep\nInjective Network.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j94nkmEc5W"}],"key":"rOBWEoAU1s"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Also, notice that the generated curve never self intersects.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"p4GOeicYZn"}],"key":"S4iISRdHHA"}],"key":"Gk5UOvDGoJ"},{"type":"block","kind":"notebook-content","data":{},"children":[],"key":"TFb4IsZyqB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom ipywidgets import Button, VBox, Output, Layout\nfrom IPython.display import display\n\ndef LeakyReLU(x, alpha = 0.1):\n    return np.maximum(alpha * x, x)\n\ndef injective_net(t):\n    # Perform the transformation for closed curves\n    z = np.hstack([np.cos(2 * np.pi * t), np.sin(2 * np.pi * t)])\n    a = LeakyReLU(z)\n\n    # Perform the linear and non-linear transformations\n    layer_count = 2\n    for i in range(layer_count):\n        A = np.random.random((2, 2)) - 0.5\n        z = a @ A\n        a = LeakyReLU(z)\n    \n    return a\n\n# Create an output widget to display the plot\noutput = Output()\n\n# Function to execute when the button is clicked\ndef generate_plot(_):\n    with output:\n        output.clear_output(wait = True)  # Clear previous output for fresh plot\n        num_pts = 1000\n        t = np.linspace(0, 1, num_pts).reshape(-1, 1)\n\n        X = injective_net(t)\n\n        # Plot the result\n        plt.plot(X[:, 0], X[:, 1])\n        plt.show()\n\n# Create a button widget\nbutton = Button(\n    description = \"Generate Curve\",\n)\nbutton.on_click(generate_plot)\n\n# Display the button and output together\ndisplay(VBox([button, output]))","visibility":"hide","key":"sfNwiKcCZS"},{"type":"output","id":"XcIs9M8xQg2dgvLtG5bUY","data":[],"visibility":"show","key":"Un3ctt5ryp"}],"data":{"tags":[]},"visibility":"show","key":"DtdhMac9qD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Fitting Target Curves: Curve Similarity Metrics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QNV7gE7Vzy"}],"identifier":"fitting-target-curves-curve-similarity-metrics","label":"Fitting Target Curves: Curve Similarity Metrics","html_id":"fitting-target-curves-curve-similarity-metrics","implicit":true,"key":"s4yFLheOBd"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Now that we have a shape parameterization method that represents only simple closed curves, we would\nlike to fit it to target shapes. This is useful in various scenarios: starting an optimization from\na particular initial shape, exploring the representative power of a given depth network, the effect\nof activation functions on the types of shapes that we can represent etc.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gGkv9VG5aj"}],"key":"FKh4Myku3R"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Let’s say we have a target shape specified (say the Stanford Bunny","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"R9NOiGhG5W"},{"type":"footnoteReference","identifier":"stanford_bunny","label":"stanford_bunny","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"number":3,"enumerator":"3","key":"GGUcgfDeZH"},{"type":"text","value":") and we want our\nparameterization to represent that shape as closely as possible. To represent the given shape one\nway would be to tune the parameters of the representation scheme iteratively using a gradient descent\noptimization approach. This requires us to define an objective function that can then be optimized\nover. An appropriate objective for this task would be some measure of similarity(or dissimilarity)\nbetween the target curve and the one traced out by our parameterization. The objective function can\nthen be maximized(or minimized) to fit the parameters.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"C74TxjNeaH"}],"key":"ca2JgiPGrY"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"For details on similarity metrics refer to the tutorial on ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"XIkYRYlfWG"},{"type":"link","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Curve Similarity Measures","key":"Vl2pVs4VG7"}],"identifier":"curve_similarity_measures","label":"curve_similarity_measures","url":"/curve-similarity-measures","internal":true,"dataUrl":"/curve-similarity-measures.json","key":"iMchKbji4J"},{"type":"text","value":".","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"l00tv9uSGk"}],"key":"KUlZMWgfmZ"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Here we will assume that we have some curve similarity measures available to us defined as loss\nfunctions in PyTorch. We will use these directly to fit shapes. In particular we have the following\nsetup:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"cp8S8wbTkd"}],"key":"auNDQNJZtk"},{"type":"container","kind":"table","children":[{"type":"caption","children":[{"type":"paragraph","children":[{"type":"captionNumber","kind":"table","label":"optimization_problem_setup","identifier":"optimization_problem_setup","html_id":"optimization-problem-setup","enumerator":"1","children":[{"type":"text","value":"Table ","key":"zXp9jlKkES"},{"type":"text","value":"1","key":"WbCnx2RdP4"},{"type":"text","value":":","key":"IFI4UnDB4C"}],"template":"Table %s:","key":"bmcMefNSdH"},{"type":"text","value":"The optimization problem setup","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"q5FmU3fYG0"}],"key":"zqnVpYOSuZ"}],"key":"avso3iRvGl"},{"type":"table","position":{"start":{"line":24,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Object","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"B4D3OsYdve"}],"key":"cxPOh21Chp"},{"type":"tableCell","header":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Details","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"dIKJa6mesk"}],"key":"MYHjmcnD7P"}],"key":"c5nqYSO1WX"},{"type":"tableRow","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Shape Parameterization","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"SoSDm6XE4S"}],"key":"mei8UuKmGK"},{"type":"tableCell","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Injective Network with parameters ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"ERKLseZBsJ"},{"type":"text","value":"ϕ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"vBfJI0ejNN"}],"key":"KwOzKUjbys"}],"key":"GEvNouyhod"},{"type":"tableRow","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Parametrized Curve","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"ngm2rVvCud"}],"key":"dnVzG5EGQe"},{"type":"tableCell","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Sampled at discrete ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"j4SIYy0tms"},{"type":"inlineMath","value":"t \\in [0, 1)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">t \\in [0, 1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"ODpZfb4UlE"},{"type":"text","value":" from Injective Network, stored in ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"iUgQLGiaPU"},{"type":"inlineMath","value":"N_p\\times 2","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>p</mi></msub><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">N_p\\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"qUV04TXEE2"},{"type":"text","value":" matrix ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"RgSlNv4cNM"},{"type":"inlineMath","value":"X_p","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"O4SGiIPDPl"}],"key":"JmLvEKX1bl"}],"key":"l65wVdNABy"},{"type":"tableRow","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Target Curve","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"sEmrFnqCBm"}],"key":"TdtchcVIX9"},{"type":"tableCell","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Specified curve to fit, stored in ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"F378NACXQb"},{"type":"inlineMath","value":"N_t \\times 2","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mi>t</mi></msub><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">N_t \\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"KBLDQXXdf0"},{"type":"text","value":" matrix ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"CNoAStMGGY"},{"type":"inlineMath","value":"X_t","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"v7Jjdz9JVc"}],"key":"UX37WNaXZb"}],"key":"r2Y1T7Xpil"},{"type":"tableRow","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Loss Function","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"eKhYehe8BC"}],"key":"aycY3gqNRj"},{"type":"tableCell","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"inlineMath","value":"\\mathcal{L}(X_t, X_p)","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mi>p</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}(X_t, X_p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"qSQkOeV1jh"}],"key":"JO35Tj557U"}],"key":"SVX0GFTTBj"}],"key":"K19619zkd2"}],"label":"optimization_problem_setup","identifier":"optimization_problem_setup","enumerator":"1","html_id":"optimization-problem-setup","key":"DUrVtTfs6X"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Note that since ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"legimHs7UF"},{"type":"inlineMath","value":"X_p","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>p</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NHj7PTJt6q"},{"type":"text","value":" is sampled from the network with parameters ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"aKbZUoRHfu"},{"type":"text","value":"ϕ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"h0FFAdAPor"},{"type":"text","value":" it is also a function of\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"cp5NHXRVUN"},{"type":"text","value":"ϕ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"xdfUMOexJu"},{"type":"text","value":", ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"Q5qhJXu0BE"},{"type":"inlineMath","value":"X_p = X_p(\\phi)","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>p</mi></msub><mo>=</mo><msub><mi>X</mi><mi>p</mi></msub><mo stretchy=\"false\">(</mo><mi>ϕ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">X_p = X_p(\\phi)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mclose\">)</span></span></span></span>","key":"bMGiVRXqnP"},{"type":"text","value":".","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"DCYT09MiWK"}],"key":"Fy1nzlF3G5"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"gpJkMlWcRU"}],"key":"j0U5LsBgCw"}],"key":"Zgj0uaHVDh"},{"type":"text","value":": Use automatic differentiation to get gradients of ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"pWqaNc2WYi"},{"type":"inlineMath","value":"\\mathcal{L}(X_t, X_p)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo separator=\"true\">,</mo><msub><mi>X</mi><mi>p</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}(X_t, X_p)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"YDqzknrlgt"},{"type":"text","value":" w.r.t.\n","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"cfhVuF0tlh"},{"type":"text","value":"ϕ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"QvU1LjoJhc"},{"type":"text","value":" and then run gradient descent and tune the parameters.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"UQHcvukb0Y"}],"key":"VjuP1mGVMX"},{"type":"footnoteDefinition","identifier":"stanford_bunny","label":"stanford_bunny","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"The Stanford Bunny","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"wEtegZnsw3"}],"key":"zDgL0YfKDx"},{"type":"image","url":"/stanford_bunny-ff229240b51ddacea44a5bb5059b6f90.svg","alt":"The Stanford Bunny shown as a target curve.","height":"225px","align":"center","key":"vCIxjzSiaV","urlSource":"assets/stanford_bunny.svg"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"clHREBcbBS"},{"type":"link","url":"https://en.wikipedia.org/wiki/Stanford_bunny","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Stanford Bunny","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"oNNs24yZEy"}],"urlSource":"https://en.wikipedia.org/wiki/Stanford_bunny","data":{"page":"Stanford_bunny","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"E0RIk2RoDW"},{"type":"text","value":". We will use it as\na target shape against which we test our parameterization techniques.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"NM2TfjNPvq"}],"key":"iZwh355WfT"}],"number":3,"enumerator":"3","key":"eB8UXirxuW"}],"key":"QvHQFwGGe3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U7ki24qeKG"}],"identifier":"implementation","label":"Implementation","html_id":"implementation-1","implicit":true,"key":"etAZmkAHto"}],"key":"V5WsVeE9yx"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import torch\nfrom torch import nn\n\nclass InjectiveNet(nn.Module):\n    def __init__(self, layer_count, act_fn):\n        super().__init__()\n\n        # Define the transformation from t on the [0, 1] interval to unit circle for closed shapes\n        self.closed_transform = lambda t: torch.hstack([\n            torch.cos(2 * torch.pi * t),\n            torch.sin(2 * torch.pi * t)\n        ])\n\n        layers = []\n        for i in range(layer_count):\n            layers.append(nn.Linear(2, 2))\n            layers.append(act_fn())\n        \n        self.linear_act_stack = nn.Sequential(*layers)\n    \n    def forward(self, t):\n        x = self.closed_transform(t)\n        x = self.linear_act_stack(x)\n        return x","key":"mF0GTesmTF"},{"type":"output","id":"DhhARh-66ZjGhqmkWo0pe","data":[],"key":"NQrWv2n4k2"}],"key":"ZfiWYPBCWm"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Now we train Injective Networks to fit target shapes. In particular we use shapes from the\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FPupcSnetS"},{"type":"link","url":"/shapes-efd577b884665a62c6097b323fb4f69a.py","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"shapes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q9fC4Bn0z6"}],"urlSource":"./notes/curve_similarity_measures/shapes.py","static":true,"protocol":"file","key":"imw4vxI3dy"},{"type":"text","value":" python module and loss functions from the\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dKlLZs1YJY"},{"type":"link","url":"/loss_functions-de4a7071c3d337b7c8fcba6b8527ff4e.py","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss_functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B59WWXT535"}],"urlSource":"./notes/curve_similarity_measures/loss_functions.py","static":true,"protocol":"file","key":"wpkE2YXT6U"},{"type":"text","value":" module. We will use a square\nand circle as target shapes and the Mean Squared Error (MSE) loss function to quantify the\ndifference between the parameterized and the target curve.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L9OuAUEtWy"}],"key":"Rc2fZr1RF9"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We also use the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"y7nhXjRG5V"},{"type":"link","url":"/utils-10c31ea29202ad0d17a3bee71b4cad5c.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"automate_training","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qW9P16ZJTb"}],"urlSource":"./assets/utils.py","static":true,"protocol":"file","key":"WQSrFsEbKo"},{"type":"footnoteReference","identifier":"automate_training","label":"automate_training","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"number":4,"enumerator":"4","key":"krWSAPInn7"},{"type":"text","value":" function to\nhide the training details and focus on the parameterization. The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gK4aw1bjhz"},{"type":"link","url":"/utils-10c31ea29202ad0d17a3bee71b4cad5c.py","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"plot_curve","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RspzSOcf5B"}],"urlSource":"./assets/utils.py","static":true,"protocol":"file","key":"MMWKWQy7Ig"},{"type":"text","value":"\nfunction plots the target and the parameterized curves and abstracts away the plotting details.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qUCvF3NFqV"}],"key":"JT5t7tVJSF"},{"type":"footnoteDefinition","identifier":"automate_training","label":"automate_training","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The code used for automating the training of Networks is:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"F8xNNQRs8z"}],"key":"slni3Jck08"},{"type":"include","file":"assets/utils.py","literal":true,"filter":{"lines":[[1,2],[5,31]]},"children":[{"type":"code","value":"import torch\nfrom torch import nn\n\n\ndef automate_training(\n        model,\n        loss_fn,\n        X_train,\n        Y_train,\n        epochs = 1000,\n        print_cost_every = 200,\n        learning_rate = 0.001,\n):\n    optimizer = torch.optim.Adam(model.parameters(), lr = learning_rate)\n    scheduler = torch.optim.lr_scheduler.ReduceLROnPlateau(optimizer, factor = 0.99)\n\n    num_digits = len(str(epochs))\n\n    for epoch in range(epochs):\n        Y_model = model(X_train)\n        loss = loss_fn(Y_model, Y_train)\n\n        loss.backward()\n        optimizer.step()\n        optimizer.zero_grad()\n        scheduler.step(loss.item())\n\n        if epoch == 0 or (epoch + 1) % print_cost_every == 0:\n            print(f'Epoch: [{epoch + 1:{num_digits}}/{epochs}]. Loss: {loss.item():11.6f}')","lang":"python","filename":"utils.py","key":"LES1HCOU4h"}],"key":"BFSJmy2wtG"}],"number":4,"enumerator":"4","key":"GVTwMNo9Vv"}],"key":"ofabxW8Hd3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import circle, square\nfrom assets.loss_functions import mse\nfrom assets.utils import automate_training, plot_curves\n\n# Generate target curve points\nnum_pts = 1000\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\nX_t_circle = circle(num_pts)\nX_t_square = square(num_pts)\n\n# Initialize networks to learn the target shapes and train\ncircle_net = InjectiveNet(layer_count = 3, act_fn = nn.Tanh)\nsquare_net = InjectiveNet(layer_count = 3, act_fn = nn.Tanh)\n\nprint('Training Circle Net:')\nautomate_training(\n    model = circle_net, loss_fn = mse, X_train = t, Y_train = X_t_circle,\n    learning_rate = 0.1, epochs = 1000, print_cost_every = 200\n)\nprint('Training Square Net:')\nautomate_training(\n    model = square_net, loss_fn = mse, X_train = t, Y_train = X_t_square,\n    learning_rate = 0.1, epochs = 1000, print_cost_every = 200\n)\n\n# Get final curve represented by the networks\nX_p_circle = circle_net(t)\nX_p_square = square_net(t)\n\n# Plot the curves\nplot_curves(X_p_circle, X_t_circle)\nplot_curves(X_p_square, X_t_square)","key":"FSGe7xqKYa"},{"type":"output","id":"e7wQYCqDkbFV5T-KT5CyW","data":[{"name":"stdout","output_type":"stream","text":"Training Circle Net:\nEpoch: [   1/1000]. Loss:    1.304349\nEpoch: [ 200/1000]. Loss:    0.002472\nEpoch: [ 400/1000]. Loss:    0.002342\nEpoch: [ 600/1000]. Loss:    0.002285\nEpoch: [ 800/1000]. Loss:    0.002254\nEpoch: [1000/1000]. Loss:    0.002236\nTraining Square Net:\nEpoch: [   1/1000]. Loss:    1.598441\nEpoch: [ 200/1000]. Loss:    0.000795\nEpoch: [ 400/1000]. Loss:    0.000600\nEpoch: [ 600/1000]. Loss:    0.000409\nEpoch: [ 800/1000]. Loss:    0.000304\nEpoch: [1000/1000]. Loss:    0.000269\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ab3a319e55e8e72f81dbda9eb2c34849","path":"/ab3a319e55e8e72f81dbda9eb2c34849.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9d9268305cdf7eb4d063db752eb2dc7a","path":"/9d9268305cdf7eb4d063db752eb2dc7a.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"DhBh7g5vJa"}],"key":"Af87GVSdOM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Awesome! We see that we are doing good on simple shapes. Now we move onto something challenging.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zmbLma42GY"}],"key":"SpoAaDyqQt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Let’s test the method on the Stanford Bunny. We will treat the Stanford Bunny as our recurring\nevaluation target for different architectures. Therefore we will use a fixed number of points on the\ntarget bunny curve to maintain consistency across curve fitting results.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hvhvUNiAVu"}],"key":"jq71FD26YE"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"We now try different ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hEfs9s3CdY"},{"type":"inlineCode","value":"layer_count","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vqSwlgNYMV"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yfVHcqt2Fw"},{"type":"inlineCode","value":"act_fn","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"x0MrbJP512"},{"type":"text","value":" to try and fit the bunny. We recommend you to play\naround with the code below to get a good feel for curve fitting capacity of Injective Networks.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"k1MfAJwiTP"}],"key":"U1RdKsvLJr"}],"key":"STxPf9shW5"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import stanford_bunny\n\n# Generate target curve points\nX_t_bunny = stanford_bunny(num_points = 1000)\nnum_pts = X_t_bunny.shape[0]\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\n\nbunny_net = InjectiveNet(layer_count = 5, act_fn = nn.LeakyReLU)\n\nautomate_training(bunny_net, mse, t, X_t_bunny, learning_rate = 0.1, epochs = 1000, print_cost_every = 200)\n\nX_p_bunny = bunny_net(t)\nplot_curves(X_p_bunny, X_t_bunny)","key":"tToTz2mE1e"},{"type":"output","id":"pZLrK3tPIt898CyqFvCIC","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [   1/1000]. Loss:    0.996990\nEpoch: [ 200/1000]. Loss:    0.517826\nEpoch: [ 400/1000]. Loss:    0.071477\nEpoch: [ 600/1000]. Loss:    0.037948\nEpoch: [ 800/1000]. Loss:    0.027589\nEpoch: [1000/1000]. Loss:    0.023397\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"157ed32ca4b830f179015bd23518ca05","path":"/157ed32ca4b830f179015bd23518ca05.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"Pq7EEEHZ8Y"}],"key":"bsinVx4sMQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We observe very poor performance❗⚠️","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q2oVh9pSan"}],"key":"Y9NgpwZTLb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"If you played around with the code above you would have observed that Injective Networks on their\nown:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tLInrNN6A5"}],"key":"eAgYnm8Qhp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"can get stuck in local optima.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TOGBZ2X61N"}],"key":"nic10VrGf0"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"can fail to be expressive enough.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NdsOp3U0Rk"}],"key":"jHYVXMUGMZ"}],"key":"d3DU19zt3c"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"To get ideas on improving the parameterization we first “","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"J4rqthnQ2v"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"cheat","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RcXPgBgov1"}],"key":"YSAjcxLMWT"},{"type":"text","value":"” a little and use the\n","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"dC5ntPLctq"},{"type":"inlineCode","value":"PReLU","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Iinm7WLfPW"},{"type":"footnoteReference","identifier":"prelu","label":"prelu","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"number":5,"enumerator":"5","key":"CRtEjXCL3F"},{"type":"text","value":" activation function. ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"kXN86fqJIG"},{"type":"inlineCode","value":"PReLU","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"V7kzq5nmd2"},{"type":"text","value":" has a learnable slope parameter ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qf8K1OIUdg"},{"type":"text","value":"α","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"gYCZKapKNb"},{"type":"text","value":" which can\nduring training become negative and therefore violate the injectivity property required from the\nactivation function for non-self intersection. Therefore, in general ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vPMAnIiMym"},{"type":"inlineCode","value":"PReLU","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ACkBxnPJ8d"},{"type":"text","value":" cannot be used in\nInjective Networks but we use it here to gain insights into improving the method further.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"OrYYhLq6Rs"}],"label":"why_prelu","identifier":"why_prelu","html_id":"why-prelu","key":"HAsEBcGfyS"},{"type":"footnoteDefinition","identifier":"prelu","label":"prelu","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"https://pytorch.org/docs/stable/generated/torch.nn.PReLU.html","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"PyTorch PReLU","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"J2MDdG4i8s"}],"urlSource":"https://pytorch.org/docs/stable/generated/torch.nn.PReLU.html","key":"YQxbN4rVKp"}],"key":"XOLXNkRbKM"},{"type":"blockquote","children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Applies the element-wise PReLU function.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"A4oCc1e2IL"}],"key":"uPM9AwDUxX"},{"type":"math","value":"\\text{PReLU}(x) = \\max(0,x) + a * \\min(0,x)","position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>PReLU</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>a</mi><mo>∗</mo><mi>min</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\text{PReLU}(x) = \\max(0,x) + a * \\min(0,x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">PReLU</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4653em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">min</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"6","key":"rkG3v3GJHs"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"or","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"n6AQ0nnj1r"}],"key":"T2cTKvA3JX"},{"type":"math","value":"\\text{PReLU}(x) =\n\\begin{cases}\nx, & \\text{ if } x \\ge 0 \\\\\nax, & \\text{ otherwise }\n\\end{cases}","position":{"start":{"line":25,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>PReLU</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>x</mi><mo separator=\"true\">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mtext> if </mtext><mi>x</mi><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>a</mi><mi>x</mi><mo separator=\"true\">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext> otherwise </mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">\\text{PReLU}(x) =\n\\begin{cases}\nx, &amp; \\text{ if } x \\ge 0 \\\\\nax, &amp; \\text{ otherwise }\n\\end{cases}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">PReLU</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">{</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.69em;\"><span style=\"top:-3.69em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> if </span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\"> otherwise </span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.19em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"7","key":"NzqntyXTs5"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"EWl8SyH9xS"},{"type":"inlineMath","value":"a","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"zy3axvXYsD"},{"type":"text","value":" is a learnable parameter. When called without arguments, ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"SHk1t3Aeyh"},{"type":"inlineCode","value":"nn.PReLU()","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"mAZyToylWX"},{"type":"text","value":" uses a single\nparameter ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"IiOsu37UJV"},{"type":"inlineMath","value":"a","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"qoqW3N3dht"},{"type":"text","value":" across all input channels.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"KwAZjR5qz1"}],"key":"znWPrO2r6r"}],"key":"Hiy5nlDVys"}],"number":5,"enumerator":"5","key":"LUxbkqzoy8"}],"key":"DSIQ5TIIrM"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from assets.shapes import stanford_bunny\n\n# Generate target curve points\nX_t_bunny = stanford_bunny(num_points = 100)\nnum_pts = X_t_bunny.shape[0]\nt = torch.linspace(0, 1, num_pts).reshape(-1, 1)\n\nbunny_net = InjectiveNet(layer_count = 5, act_fn = nn.PReLU)\n\nautomate_training(bunny_net, mse, t, X_t_bunny, learning_rate = 0.1, epochs = 10000, print_cost_every = 2000)\n\nX_p_bunny = bunny_net(t)\nplot_curves(X_p_bunny, X_t_bunny)","key":"oOBQTby6ug"},{"type":"output","id":"mswQ_F2kOJkn33xCFRA7u","data":[{"name":"stdout","output_type":"stream","text":"Epoch: [    1/10000]. Loss:    0.741841\nEpoch: [ 2000/10000]. Loss:    0.008849\nEpoch: [ 4000/10000]. Loss:    0.007889\nEpoch: [ 6000/10000]. Loss:    0.006868\nEpoch: [ 8000/10000]. Loss:    0.006707\nEpoch: [10000/10000]. Loss:    0.006620\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4212974e0562596254da43d79b5d6567","path":"/4212974e0562596254da43d79b5d6567.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"Ahj2fdZL2e"}],"key":"HFT2jUHMAH"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We see an exciting improvement! Injective Networks with ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BvsE3yzKJ1"},{"type":"inlineCode","value":"PReLU","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fPYsqkXxyZ"},{"type":"text","value":" do much better. This gives us the\nfollowing insight:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rAGrTjJxg6"}],"label":"parameter_insight","identifier":"parameter_insight","html_id":"parameter-insight","key":"dosCZjRHMh"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Injective Networks are ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QvJkNzKTwW"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"parameter deficient","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FPyRW3QQKA"}],"key":"dv92qU0ybG"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OaMsLxMTzL"}],"key":"SE2ZwlEpPA"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Adding parameters gives them much more representation power.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"x0TbAwc83p"}],"key":"ChXQNQfQGA"}],"key":"dOmtGU9lhI"}],"key":"DaX0aosYjd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We will come back to address this in.ajlsdjfklasdkf\nBut for now we look at auxilliary networks.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NppqZR5UzG"}],"key":"BVjDnH7TQc"}],"key":"yXM1rX8rA3"}],"key":"WlTaz7cLrM"},"references":{"cite":{"order":[],"data":{}}}}